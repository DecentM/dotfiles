# Shell command permissions for the sh custom tool
# Patterns are matched in order - first match wins
# Default action if no pattern matches: deny
#
# Format:
#   pattern: glob pattern (* matches any characters) - for single patterns
#   patterns: array of glob patterns - for multiple patterns with same decision/reason
#   decision: allow | deny
#   reason: explanation shown to model when denied (helps it adapt)
#
# Constraints (for allowed commands):
#   constraints: array of constraints (all must pass)
#
# Constraint types:
#   cwd_only        - paths must be within working directory
#                     options: also_allow: ["/tmp"], exclude: [".git", ".env*"]
#   no_recursive    - block -r, -R, --recursive flags
#   no_force        - block -f, --force flags
#   max_depth       - require -maxdepth N where N <= value
#                     options: value: 5
#   require_flag    - require specific flag to be present
#                     options: flag: "--dry-run"

default: deny
default_reason: "Command not in allowlist - if you need this command, ask the user to run it or request it be added to permissions"

rules:
  # ─────────────────────────────────────────────────────────────────────────────
  # Directory navigation - constrained to cwd
  # ─────────────────────────────────────────────────────────────────────────────
  - pattern: "cd *"
    decision: allow
    constraints:
      - cwd_only
    reason: "Cannot cd outside working directory - stay within the project"

  - pattern: "cd"
    decision: deny
    reason: "cd with no arguments goes to home directory - use 'cd .' or specify a path within cwd"

  # ─────────────────────────────────────────────────────────────────────────────
  # Explicit denies - dangerous or restricted commands
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "python*"
      - "python3*"
    decision: deny
    reason: "Use python tool for Python execution - it provides isolated containers"

  - patterns:
      - "node*"
      - "deno*"
    decision: deny
    reason: "Use sandbox-node-deno MCP for Node.js/Deno execution - it provides isolated containers"

  # Bun - specific allows before general deny
  - patterns:
      - "bun run*"
      - "bun test*"
      - "bun build*"
      - "bun install*"
      - "bun add*"
      - "bun pm ls*"
      - "bun pm cache*"
      - "bun outdated*"
      - "bun --version"
      - "bun --help"
    decision: allow

  - pattern: "bun remove*"
    decision: deny
    reason: "Removing packages requires user confirmation - ask the user to run this command"

  - pattern: "bun*"
    decision: deny
    reason: "Use sandbox-node-deno MCP for Bun execution - it provides isolated containers"

  - patterns:
      - "rm*"
    decision: deny
    reason: "File/directory deletion is not permitted - ask the user to delete manually"

  - pattern: "mv*"
    decision: deny
    reason: "File moving/renaming via shell is not permitted - use the edit tool or ask the user"

  - pattern: "chmod*"
    decision: deny
    reason: "Permission changes are not permitted - ask the user to change permissions manually"

  - pattern: "chown*"
    decision: deny
    reason: "Ownership changes are not permitted - ask the user to change ownership manually"

  - pattern: "sudo*"
    decision: deny
    reason: "Elevated privileges are not permitted - ask the user to run privileged commands"

  - pattern: "su*"
    decision: deny
    reason: "User switching is not permitted"

  - pattern: "htop*"
    decision: deny
    reason: "Interactive programs don't work - use 'top -bn1' for a snapshot instead"

  - patterns:
      - "vim*"
      - "nano*"
      - "emacs*"
    decision: deny
    reason: "Interactive editors don't work - use the edit/write tools instead"

  - patterns:
      - "less*"
      - "more*"
    decision: deny
    reason: "Interactive pagers don't work - use cat, head, or tail instead"

  # Shell scripts - need review
  - pattern: "*.sh"
    decision: deny
    reason: "Shell scripts need user review before execution - describe what the script does and ask the user to run it"

  - patterns:
      - "bash*"
      - "zsh*"
      - "sh *"
    decision: deny
    reason: "Use the sh tool directly - nested shell invocation is not permitted"

  - pattern: "bin/*"
    decision: deny
    reason: "Scripts in bin/ need user review - describe what the script does and ask the user to run it"

  - pattern: "./*"
    decision: deny
    reason: "Relative executables need user review - describe what it does and ask the user to run it"

  - pattern: "eval*"
    decision: deny
    reason: "Dynamic code evaluation is not permitted for security reasons"

  - pattern: "exec*"
    decision: deny
    reason: "Process replacement is not permitted"

  - pattern: "source*"
    decision: deny
    reason: "Sourcing scripts is not permitted - run commands directly"

  # ─────────────────────────────────────────────────────────────────────────────
  # Containers - Docker
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "docker rm*"
      - "docker rmi*"
      - "docker stop*"
      - "docker kill*"
      - "docker system prune*"
      - "docker volume rm*"
      - "docker network rm*"
    decision: deny
    reason: "Docker resource deletion/stopping requires user confirmation - ask the user to run this command"

  # Docker - read-only and safe commands
  - patterns:
      - "docker build*"
      - "docker manifest inspect*"
      - "docker search*"
      - "docker pull*"
      - "docker logs*"
      - "docker images*"
      - "docker run*"
      - "docker ps*"
      - "docker inspect*"
      - "docker info*"
      - "docker info"
      - "docker version*"
      - "docker version"
      - "docker stats*"
      - "docker top*"
      - "docker port*"
      - "docker diff*"
      - "docker history*"
      - "docker events*"
      - "docker cp*"
      - "docker tag*"
      - "docker network ls*"
      - "docker network inspect*"
      - "docker volume ls*"
      - "docker volume inspect*"
      - "docker system df*"
      - "docker system info*"
      - "docker container ls*"
      - "docker container logs*"
      - "docker container inspect*"
      - "docker image ls*"
      - "docker image inspect*"
      - "docker image history*"
      - "docker buildx*"
      - "docker context*"
      - "docker help*"
      - "docker --version"
      - "docker --help"
    decision: allow

  # Docker Compose
  - patterns:
      - "docker compose ps*"
      - "docker compose logs*"
      - "docker compose config*"
      - "docker compose top*"
      - "docker compose images*"
      - "docker compose port*"
      - "docker compose version*"
      - "docker compose ls*"
      - "docker compose --help"
      - "docker-compose ps*"
      - "docker-compose logs*"
      - "docker-compose config*"
      - "docker-compose top*"
      - "docker-compose images*"
      - "docker-compose port*"
      - "docker-compose version*"
      - "docker-compose --help"
    decision: allow

  # Fallback deny for other docker commands
  - pattern: "docker*"
    decision: deny
    reason: "This docker command is not in the allowlist - ask the user if you need to run it"

  - pattern: "docker-compose*"
    decision: deny
    reason: "This docker-compose command is not in the allowlist - ask the user if you need to run it"

  # Distrobox - read-only only
  - patterns:
      - "distrobox list*"
      - "distrobox ls*"
      - "distrobox version*"
      - "distrobox --help"
      - "distrobox-export --list-apps*"
      - "distrobox-export --list-binaries*"
      - "distrobox-export --help"
      - "distrobox-export --version"
    decision: allow

  - pattern: "distrobox*"
    decision: deny
    reason: "Distrobox container management requires user confirmation - ask the user to run this command"

  # ─────────────────────────────────────────────────────────────────────────────
  # Infrastructure - kubectl
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "kubectl apply*"
      - "kubectl delete*"
      - "kubectl create*"
      - "kubectl patch*"
      - "kubectl scale*"
      - "kubectl rollout*"
    decision: deny
    reason: "Mutating Kubernetes resources requires user confirmation - ask the user to run this command"

  - pattern: "kubectl edit*"
    decision: deny
    reason: "Interactive editing doesn't work - use kubectl get -o yaml, modify, then ask user to apply"

  - patterns:
      - "kubectl describe*"
      - "kubectl get*"
      - "kubectl logs*"
      - "kubectl run*"
      - "kubectl exec*"
      - "kubectl wait*"
      - "kubectl create job*"
      - "kubectl delete job*"
      - "kubectl version*"
      - "kubectl version"
      - "kubectl config view*"
      - "kubectl config get*"
      - "kubectl config current-context*"
      - "kubectl cluster-info*"
      - "kubectl api-resources*"
      - "kubectl api-versions*"
      - "kubectl explain*"
      - "kubectl top*"
      - "kubectl auth can-i*"
      - "kubectl diff*"
      - "kubectl events*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Infrastructure - helm
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "helm install*"
      - "helm upgrade*"
      - "helm uninstall*"
      - "helm rollback*"
    decision: deny
    reason: "Mutating Helm releases requires user confirmation - ask the user to run this command"

  - patterns:
      - "helm list*"
      - "helm status*"
      - "helm get*"
      - "helm show*"
      - "helm search*"
      - "helm repo list*"
      - "helm history*"
      - "helm template*"
      - "helm lint*"
      - "helm verify*"
      - "helm version*"
      - "helm env*"
      - "helm dependency list*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Infrastructure - terraform
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "terraform apply*"
      - "terraform destroy*"
      - "terraform import*"
      - "terraform taint*"
      - "terraform untaint*"
    decision: deny
    reason: "Mutating Terraform resources requires user confirmation - ask the user to run this command"

  - patterns:
      - "terraform init*"
      - "terraform plan*"
      - "terraform show*"
      - "terraform validate*"
      - "terraform fmt*"
      - "terraform version*"
      - "terraform output*"
      - "terraform state list*"
      - "terraform state show*"
      - "terraform providers*"
      - "terraform graph*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Shell utilities - with path constraints
  # ─────────────────────────────────────────────────────────────────────────────

  # File reading - constrained to cwd
  - patterns:
      - "cat*"
      - "head*"
      - "head"
      - "tail*"
      - "tail"
    decision: allow
    constraints:
      - cwd_only
    reason: "Cannot read files outside working directory"

  # Search commands - constrained to cwd
  - patterns:
      - "grep*"
      - "rg*"
    decision: allow
    constraints:
      - cwd_only
    reason: "Cannot search outside working directory"

  # Find - constrained to cwd with depth limit
  - pattern: "find*"
    decision: allow
    constraints:
      - type: cwd_only
        exclude:
          - node_modules
          - .git
      - type: max_depth
        value: 10
    reason: "find must stay within cwd, exclude heavy dirs, and specify -maxdepth"

  # Directory listing - constrained to cwd
  - patterns:
      - "ls*"
      - "ls"
      - "tree*"
    decision: allow
    constraints:
      - cwd_only
    reason: "Cannot list directories outside working directory"

  # Disk usage - constrained to cwd
  - patterns:
      - "du*"
    decision: allow
    constraints:
      - cwd_only
    reason: "Cannot check disk usage outside working directory"

  # File info - constrained to cwd
  - patterns:
      - "stat*"
      - "file*"
    decision: allow
    constraints:
      - cwd_only
    reason: "Cannot get file info outside working directory"

  # File creation - constrained to cwd
  - patterns:
      - "mkdir*"
      - "touch*"
    decision: allow
    constraints:
      - cwd_only
    reason: "Cannot create files/directories outside working directory"

  # Copy and link - constrained to cwd, no recursive
  - patterns:
      - "cp*"
      - "ln*"
    decision: allow
    constraints:
      - cwd_only
      - no_recursive
    reason: "cp/ln constrained to cwd and non-recursive"

  # Non-path shell utilities - no constraints needed
  - patterns:
      - "true"
      - "false"
      - "sed*"
      - "uniq*"
      - "uniq"
      - "sort*"
      - "sort"
      - "awk*"
      - "cut*"
      - "wc*"
      - "wc"
      - "ping*"
      - "curl*"
      - "echo*"
      - "echo"
      - "printf*"
      - "printf"
      - "paste*"
      - "column*"
      - "xargs*"
      - "basename*"
      - "wget*"
      - "jq*"
      - "jq"
      - "yq*"
      - "yq"
      - "pwd"
      - "which*"
      - "sleep*"
      - "dirname*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # System info - read-only
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "uname*"
      - "hostname"
      - "hostname -f"
      - "hostname -I"
      - "whoami"
      - "id"
      - "id*"
      - "groups"
      - "groups*"
      - "uptime*"
      - "free*"
      - "df*"
      - "du*"
      - "lsblk*"
      - "lscpu*"
      - "lsmem*"
      - "lspci*"
      - "lsusb*"
      - "lsmod*"
      - "lsns*"
      - "lsof*"
      - "lsipc*"
      - "lslocks*"
      - "nproc*"
      - "getconf*"
      - "arch"
      - "w"
      - "who"
      - "who*"
      - "last*"
      - "lastlog*"
      - "getent*"
      - "locale*"
      - "timedatectl"
      - "timedatectl status"
      - "timedatectl show"
      - "hostnamectl"
      - "hostnamectl status"
      - "loginctl list*"
      - "loginctl show*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Process info - read-only
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "ps*"
      - "ps"
      - "pgrep*"
      - "pidof*"
      - "top -bn1*"
      - "pstree*"
      - "fuser*"
      - "jobs"
      - "wait*"
      - "watch*"
    decision: allow

  # Process control - deny
  - patterns:
      - "kill*"
      - "pkill*"
      - "killall*"
    decision: deny
    reason: "Killing processes requires user confirmation - ask the user to run this command"

  # ─────────────────────────────────────────────────────────────────────────────
  # Logs and debug - read-only
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "journalctl*"
      - "dmesg*"
      - "systemctl status*"
      - "systemctl is-active*"
      - "systemctl is-enabled*"
      - "systemctl is-failed*"
      - "systemctl list-units*"
      - "systemctl list-unit-files*"
      - "systemctl list-timers*"
      - "systemctl list-sockets*"
      - "systemctl list-jobs*"
      - "systemctl list-dependencies*"
      - "systemctl show*"
      - "systemctl cat*"
      - "systemctl help*"
      - "systemctl --version"
      - "strace*"
      - "ltrace*"
    decision: allow

  # Systemctl management - deny
  - patterns:
      - "systemctl start*"
      - "systemctl stop*"
      - "systemctl restart*"
      - "systemctl enable*"
      - "systemctl disable*"
      - "systemctl mask*"
      - "systemctl unmask*"
      - "systemctl daemon-reload*"
    decision: deny
    reason: "Managing services requires user confirmation - ask the user to run this command"

  # ─────────────────────────────────────────────────────────────────────────────
  # File info and checksums - constrained to cwd
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "readlink*"
      - "realpath*"
      - "namei*"
      - "getfacl*"
      - "lsattr*"
    decision: allow
    constraints:
      - cwd_only
    reason: "Cannot get file info outside working directory"

  # Checksums - constrained to cwd
  - patterns:
      - "md5sum*"
      - "sha1sum*"
      - "sha256sum*"
      - "sha512sum*"
      - "sha224sum*"
      - "sha384sum*"
      - "b2sum*"
      - "cksum*"
      - "sum*"
    decision: allow
    constraints:
      - cwd_only
    reason: "Cannot compute checksums for files outside working directory"

  # Diff/compare - constrained to cwd
  - patterns:
      - "diff*"
      - "cmp*"
      - "comm*"
    decision: allow
    constraints:
      - cwd_only
    reason: "Cannot compare files outside working directory"

  # ─────────────────────────────────────────────────────────────────────────────
  # Text processing
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "tr*"
      - "tee*"
      - "rev*"
      - "nl*"
      - "expand*"
      - "unexpand*"
      - "fold*"
      - "fmt*"
      - "join*"
      - "split*"
      - "csplit*"
      - "colrm*"
      - "pr*"
      - "tsort*"
      - "numfmt*"
      - "base64*"
      - "base32*"
      - "od*"
      - "xxd*"
      - "hexdump*"
      - "strings*"
      - "iconv*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Network diagnostics - read-only
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "ip addr*"
      - "ip link show*"
      - "ip route show*"
      - "ip route get*"
      - "ip neigh*"
      - "ip -s*"
      - "ip a*"
      - "ip r*"
    decision: allow

  # IP management - deny
  - patterns:
      - "ip link set*"
      - "ip route add*"
      - "ip route del*"
    decision: deny
    reason: "Network interface/route changes require user confirmation - ask the user to run this command"

  - patterns:
      - "ss*"
      - "netstat*"
      - "ifconfig*"
      - "route*"
      - "dig*"
      - "nslookup*"
      - "host*"
      - "traceroute*"
      - "tracepath*"
      - "mtr*"
      - "whois*"
      - "arp*"
      - "ethtool*"
      - "iwconfig*"
      - "iw*"
      - "nmcli*"
      - "resolvectl*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Archive operations - read/extract only, constrained to cwd
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "tar tf*"
      - "tar --list*"
      - "tar -tf*"
      - "tar -tvf*"
      - "tar -xf*"
      - "tar -xvf*"
      - "tar -xzf*"
      - "tar -xjf*"
    decision: allow
    constraints:
      - cwd_only
    reason: "Cannot extract archives outside working directory"

  # Tar creation - deny
  - patterns:
      - "tar cf*"
      - "tar czf*"
      - "tar cjf*"
    decision: deny
    reason: "Creating archives requires user confirmation - ask the user to run this command"

  - patterns:
      - "unzip*"
      - "zipinfo*"
      - "zcat*"
      - "zless*"
      - "zmore*"
      - "zgrep*"
      - "gunzip*"
      - "gzip -l*"
      - "gzip -t*"
      - "xz -l*"
      - "xz -t*"
      - "xzcat*"
      - "unxz*"
      - "bzip2 -d*"
      - "bunzip2*"
      - "bzcat*"
      - "7z l*"
      - "7z x*"
      - "7z e*"
      - "unrar*"
    decision: allow
    constraints:
      - cwd_only
    reason: "Cannot extract archives outside working directory"

  # Archive creation - deny
  - patterns:
      - "zip*"
      - "gzip*"
      - "bzip2*"
      - "xz*"
    decision: deny
    reason: "Creating/compressing archives requires user confirmation - ask the user to run this command"

  # ─────────────────────────────────────────────────────────────────────────────
  # Date, time, math utilities
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "date*"
      - "cal*"
      - "ncal*"
      - "bc*"
      - "dc*"
      - "expr*"
      - "seq*"
      - "shuf*"
      - "factor*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Environment inspection
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "env"
      - "printenv*"
      - "set"
      - "declare -p*"
      - "type*"
      - "command -v*"
      - "hash*"
    decision: allow

  # Environment modification - deny
  - pattern: "export*"
    decision: deny
    reason: "Environment modification doesn't persist - set variables inline with commands instead"

  - pattern: "unset*"
    decision: deny
    reason: "Environment modification doesn't persist across commands"

  # ─────────────────────────────────────────────────────────────────────────────
  # Man pages and help
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "man*"
      - "info*"
      - "apropos*"
      - "whatis*"
      - "tldr*"
      - "help*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Build tools
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "make*"
      - "cmake*"
      - "ninja*"
      - "meson*"
      - "autoconf*"
      - "automake*"
      - "configure*"
      - "gcc*"
      - "g++*"
      - "clang*"
      - "clang++*"
      - "cc*"
      - "c++*"
      - "ld*"
      - "ar*"
      - "nm*"
      - "objdump*"
      - "readelf*"
      - "size*"
    decision: allow

  # Go
  - patterns:
      - "go build*"
      - "go test*"
      - "go run*"
      - "go mod*"
      - "go fmt*"
      - "go vet*"
      - "go doc*"
      - "go list*"
      - "go env*"
      - "go version*"
      - "go generate*"
      - "go clean*"
    decision: allow

  # Rust
  - patterns:
      - "rustc*"
      - "rustup show*"
      - "rustup which*"
      - "rustup doc*"
      - "rustup --version"
      - "rustfmt*"
      - "rust-analyzer*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Package management - npm
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "npm install*"
      - "npm i *"
      - "npm uninstall*"
      - "npm update*"
      - "npm publish*"
    decision: deny
    reason: "Package installation/mutation requires user confirmation - ask the user to run this command"

  - patterns:
      - "npm info*"
      - "npm run*"
      - "npm audit*"
      - "npm search*"
      - "npm view*"
      - "npm list*"
      - "npm ls*"
      - "npm outdated*"
      - "npm explain*"
      - "npm why*"
      - "npm fund*"
      - "npm doctor*"
      - "npm prefix*"
      - "npm root*"
      - "npm bin*"
      - "npm config list*"
      - "npm config get*"
      - "npm pack*"
      - "npm version"
      - "npm help*"
      - "npm exec*"
      - "npm test*"
      - "npm start*"
      - "npm rebuild*"
      - "npm dedupe*"
      - "npm prune*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Package management - yarn
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "yarn add*"
      - "yarn remove*"
      - "yarn upgrade*"
      - "yarn publish*"
    decision: deny
    reason: "Package installation/mutation requires user confirmation - ask the user to run this command"

  - patterns:
      - "yarn audit*"
      - "yarn info*"
      - "yarn list*"
      - "yarn why*"
      - "yarn outdated*"
      - "yarn config list*"
      - "yarn config get*"
      - "yarn version"
      - "yarn versions"
      - "yarn cache list*"
      - "yarn workspaces list*"
      - "yarn licenses list*"
      - "yarn run*"
      - "yarn build*"
      - "yarn test*"
      - "yarn lint*"
      - "yarn start*"
      - "yarn dedupe*"
      - "yarn explain*"
      - "yarn pack*"
      - "yarn help*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Package management - pnpm
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "pnpm add*"
      - "pnpm install*"
      - "pnpm remove*"
      - "pnpm update*"
      - "pnpm publish*"
    decision: deny
    reason: "Package installation/mutation requires user confirmation - ask the user to run this command"

  - patterns:
      - "pnpm audit*"
      - "pnpm list*"
      - "pnpm ls*"
      - "pnpm outdated*"
      - "pnpm why*"
      - "pnpm licenses list*"
      - "pnpm run*"
      - "pnpm exec*"
      - "pnpm env list*"
      - "pnpm root*"
      - "pnpm bin*"
      - "pnpm prefix*"
      - "pnpm store status*"
      - "pnpm config list*"
      - "pnpm config get*"
      - "pnpm build"
      - "pnpm test"
      - "pnpm start"
      - "pnpm moon"
      - "pnpm dedupe*"
      - "pnpm rebuild*"
      - "pnpm prune*"
      - "pnpm pack*"
      - "pnpm help*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Package management - cargo
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "cargo install*"
      - "cargo uninstall*"
      - "cargo publish*"
    decision: deny
    reason: "Global crate installation/publishing requires user confirmation - ask the user to run this command"

  - patterns:
      - "cargo add*"
      - "cargo check*"
      - "cargo build*"
      - "cargo test*"
      - "cargo run*"
      - "cargo doc*"
      - "cargo bench*"
      - "cargo tree*"
      - "cargo metadata*"
      - "cargo search*"
      - "cargo info*"
      - "cargo fetch*"
      - "cargo verify-project*"
      - "cargo locate-project*"
      - "cargo read-manifest*"
      - "cargo pkgid*"
      - "cargo generate-lockfile*"
      - "cargo clippy*"
      - "cargo fmt*"
      - "cargo audit*"
      - "cargo fix*"
      - "cargo clean*"
      - "cargo vendor*"
      - "cargo version*"
      - "cargo --version"
      - "cargo help*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Build and test tools
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "tsc*"
      - "eslint*"
      - "prettier*"
      - "jest*"
      - "vitest*"
      - "pytest*"
      - "time*"
      - "hyperfine*"
      - "perf*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Version control - git
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "git push*"
      - "git push"
    decision: deny
    reason: "Pushing to remote requires user confirmation - ask the user to push when ready"

  - pattern: "git reset --hard*"
    decision: deny
    reason: "Hard reset can lose work - ask the user to run this command if they're sure"

  - pattern: "git clean -f*"
    decision: deny
    reason: "Cleaning untracked files can lose work - ask the user to run this command"

  - pattern: "git rebase*"
    decision: deny
    reason: "Rebasing can rewrite history - ask the user to run this command"

  - patterns:
      - "git force*"
      - "git*--force*"
      - "git*-f *"
    decision: deny
    reason: "Force operations can lose work - ask the user to run this command"

  - pattern: "git*"
    decision: allow

  # ─────────────────────────────────────────────────────────────────────────────
  # Chezmoi - dotfiles management
  # ─────────────────────────────────────────────────────────────────────────────
  - patterns:
      - "chezmoi apply*"
      - "chezmoi update*"
      - "chezmoi init*"
    decision: deny
    reason: "Applying/updating dotfiles requires user confirmation - ask the user to run this command"

  - pattern: "chezmoi*"
    decision: allow
