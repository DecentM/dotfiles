{
  "$schema": "https://opencode.ai/config.json",
  "plugin": [
    "./plugins/audit-trail"
  ],
  "share": "manual",
  "permission": {
    "*": "deny",
    "edit": {
      "*": "allow",
      ".key": "deny",
      ".env": "deny",
      ".env.*": "deny",
      ".env.example": "allow",
    },
    "glob": "allow",
    "grep": "allow",
    "list": "allow",
    "todoread": "allow",
    "todowrite": "allow",

    // MCPs
    "sequentialthinking_*": "allow",
    "memory_*": "allow",
    "time_*": "allow",

    // Custom tools
    "python": "allow",
    "audit": "allow",
    "audit*": "allow"
  },
  "instructions": [
    "~/.dotfiles/opencode/rules/base.md",
    "AGENTS.md",
    ".cursorrules",
    ".cursor/rules/*.{md,mdx}",
  ],
  "mcp": {
    "sequentialthinking": {
      "type": "local",
      "command": [
        "docker",
        "run",
        "--rm",
        "-i",
        "--network=none",
        "--memory=512m",
        "--cpus=1",
        "mcp/sequentialthinking",
      ],
      "enabled": true,
    },
    "time": {
      "type": "local",
      "command": [
        "docker",
        "run",
        "--rm",
        "-i",
        "--network=none",
        "--memory=512m",
        "--cpus=1",
        "mcp/time",
      ],
      "enabled": true,
    },
    "github": {
      "type": "remote",
      "url": "https://api.githubcopilot.com/mcp",
      "enabled": true,
      "headers": {
        "Authorization": "Bearer {env:GITHUB_TOKEN}",
      },
    },

    "flaresolverr": {
      "type": "local",
      "command": [
        "bash",
        "-c",
        // Bundled container: Flaresolverr + Chromium + MCP server (~900MB, needs more resources)
        "docker run --rm -i --init --shm-size=2g --memory=2g --cpus=2 $(docker build -q -f ~/.dotfiles/opencode/docker/mcp-flaresolverr.dockerfile ~/.dotfiles/opencode/docker)",
      ],
      "enabled": true,
    },
  },
}
