{
  "$schema": "https://opencode.ai/config.json",
  "share": "manual",
  "permission": {
    "*": "deny",
    "edit": {
      "*": "allow",
      ".key": "deny",
      ".env": "deny",
      ".env.*": "deny",
      ".env.example": "allow",
    },
    "glob": "allow",
    "grep": "allow",
    "list": "allow",
    "todoread": "allow",
    "todowrite": "allow",
    "question": "allow",

    // MCPs
    "sequentialthinking_*": "allow",
    "memory_*": "allow",
    "time_*": "allow",

    // Custom tools
    "sandbox-python_*": "allow",
  },
  "instructions": [
    "~/.dotfiles/opencode/rules/base.md",
    "AGENTS.md",
    ".cursorrules",
    ".cursor/rules/*.{md,mdx}",
  ],
  "mcp": {
    "sequentialthinking": {
      "type": "local",
      "command": [
        "docker",
        "run",
        "--rm",
        "-i",
        "--network=none",
        "--memory=512m",
        "--cpus=1",
        "mcp/sequentialthinking",
      ],
      "enabled": true,
    },
    "time": {
      "type": "local",
      "command": [
        "docker",
        "run",
        "--rm",
        "-i",
        "--network=none",
        "--memory=512m",
        "--cpus=1",
        "mcp/time",
      ],
      "enabled": true,
    },

    // Sandbox MCP servers for safe code execution (builds inline on first run)
    "sandbox-node-deno": {
      "type": "local",
      "command": [
        "bash",
        "-c",
        "docker run --rm -i --init --network=none --memory=512m --cpus=1 $(docker build -q -f ~/.dotfiles/opencode/docker/repl-mcp.dockerfile ~/.dotfiles/opencode/docker)",
      ],
      "enabled": true,
    },
    // sandbox-python is now a standalone tool at ~/.dotfiles/opencode/tools/sandbox-python.ts
    // Build the image with: docker build -t opencode/sandbox-python -f ~/.dotfiles/opencode/docker/mcp-python.dockerfile ~/.dotfiles/opencode/docker
    "flaresolverr": {
      "type": "local",
      "command": [
        "bash",
        "-c",
        // Bundled container: Flaresolverr + Chromium + MCP server (~900MB, needs more resources)
        "docker run --rm -i --init --shm-size=2g --memory=2g --cpus=2 $(docker build -q -f ~/.dotfiles/opencode/docker/mcp-flaresolverr.dockerfile ~/.dotfiles/opencode/docker)",
      ],
      "enabled": true,
    },
  },
}
