{
  "$schema": "https://opencode.ai/config.json",
  "share": "manual",
  "permission": {
    "*": "ask",
    "bash": {
      "kubectl patch*": "deny",
      "kubectl apply*": "deny",
      "flux*": "deny",

      "kubectl describe*": "allow",
      "kubectl get*": "allow",
      "kubectl logs*": "allow",
      "kubectl run*": "allow",
      "kubectl exec*": "allow",
      "kubectl wait*": "allow",
      "kubectl create job*": "allow",
      "kubectl delete job*": "allow",
      "kubectl version*": "allow",
      "kubectl version": "allow",

      "node -e*": "deny", // use node-code-mcp

      "git add*": "deny",
      "git commit*": "deny",
      "git diff*": "allow",
      "git status": "allow",
      "git push": "deny",
      "git push*": "deny",
      "git log": "allow",
      "git log*": "allow",

      "grep*": "allow",
      "tail*": "allow",
      "tail": "allow",
      "head*": "allow",
      "head": "allow",
      "sort*": "allow",
      "sort": "allow",
      "awk*": "allow",
      "cut*": "allow",
      "wc*": "allow",
      "wc": "allow",
      "ping*": "allow",
      "curl*": "allow",
      "echo*": "allow",
      "echo": "allow",
      "printf*": "allow",
      "printf": "allow",
      "jq*": "allow",
      "jq": "allow",
      "ls*": "allow",
      "ls": "allow",
      "paste*": "allow",
      "column*": "allow",
      "xargs*": "allow",
      "find*": "allow",
      "npm info*": "allow",
      "cat*": "allow",
      "rg*": "allow", // ripgrep

      "pnpm build": "allow",
      "pnpm install": "allow",
      "pnpm moon": "allow",
    },
    "edit": {
      "*": "allow",
      ".key": "deny",
      ".env": "ask",
      ".env.*": "ask",
      ".env.example": "allow",
    },
    "glob": {
      "*": "allow",
    },
    "webfetch": "allow",
    "websearch": "allow",
    "grep": "allow",
    "list": "allow",
    "lsp": "allow",
    "task": "allow",
    "todoread": "allow",
    "todowrite": "allow",
    "question": "allow",
    "read": {
      "*": "allow",
      ".env": "ask",
      ".env.*": "ask",
      ".env.example": "ask",
    },
    "codesearch": "allow",
    "skill": "allow",

    // MCPs
    "sequentialthinking_*": "allow",
    "memory_*": "allow",
    "time_*": "allow",
    "playwright_*": "allow",
  },
  "agent": {
    "compaction": {
      "hidden": true,
      "prompt": "Save your memories with the memory tool. Then, provide a detailed prompt for continuing our conversation above. Focus on information that would be helpful for continuing the conversation, including what we did, what we're doing, which files we're working on, and what we're going to do next considering new session will not have access to our conversation.",
    },
  },
  "instructions": [
    "~/.dotfiles/opencode/rules/base.md",
    "AGENTS.md",
    ".cursor/rules/*.{md,mdx}",
  ],
  "mcp": {
    "sequentialthinking": {
      "type": "local",
      "command": ["docker", "run", "--rm", "-i", "mcp/sequentialthinking"],
      "enabled": true,
    },
    "time": {
      "type": "local",
      "command": ["docker", "run", "--rm", "-i", "mcp/time"],
      "enabled": true,
    },
    "playwright": {
      "type": "local",
      "command": [
        "docker",
        "run",
        "--rm",
        "-i",
        "--init",
        "mcr.microsoft.com/playwright/mcp",
      ],
      "enabled": true,
    },
  },
}
