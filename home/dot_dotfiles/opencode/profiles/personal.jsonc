{
  "$schema": "https://opencode.ai/config.json",
  "theme": "ariake-dark",
  "share": "manual",
  "instructions": ["~/.dotfiles/opencode/rules/personal.md"],

  "provider": {
    "ollama-local": {
      "api": "openai-compatible",
      "id": "ollama",
      "name": "Ollama (Local)",
      "options": {
        "baseURL": "http://localhost:11434/v1",
        "apiKey": "ollama",
        "timeout": 600000
      },
      "models": {
        "qwen2.5-coder:7b": {
          "id": "qwen2.5-coder:7b",
          "name": "Qwen 2.5 Coder 7B",
          "family": "qwen",
          "release_date": "2024-09-19",
          "attachment": false,
          "reasoning": false,
          "temperature": true,
          "tool_call": true,
          "limit": {
            "context": 32768,
            "output": 8192
          },
          "modalities": {
            "input": ["text"],
            "output": ["text"]
          },
          "cost": {
            "input": 0,
            "output": 0,
            "cache_read": 0,
            "cache_write": 0
          }
        },
        "llama3.2:3b": {
          "id": "llama3.2:3b",
          "name": "Llama 3.2 3B",
          "family": "llama",
          "release_date": "2024-09-25",
          "attachment": false,
          "reasoning": false,
          "temperature": true,
          "tool_call": false,
          "limit": {
            "context": 131072,
            "output": 8192
          },
          "modalities": {
            "input": ["text"],
            "output": ["text"]
          },
          "cost": {
            "input": 0,
            "output": 0,
            "cache_read": 0,
            "cache_write": 0
          }
        },
        "deepseek-coder-v2:16b": {
          "id": "deepseek-coder-v2:16b",
          "name": "DeepSeek Coder V2 16B",
          "family": "deepseek",
          "release_date": "2024-06-17",
          "attachment": false,
          "reasoning": false,
          "temperature": true,
          "tool_call": true,
          "limit": {
            "context": 16384,
            "output": 4096
          },
          "modalities": {
            "input": ["text"],
            "output": ["text"]
          },
          "cost": {
            "input": 0,
            "output": 0,
            "cache_read": 0,
            "cache_write": 0
          }
        }
      }
    }
  },

  "small_model": "ollama-local/llama3.2:3b",
  "model": "ollama-local/qwen2.5-coder:7b",

  // Model selection and profile-specific permission overrides
  // Agent behavior is defined in agents/*.md files
  "agent": {
    // Primary agents - homeassistant access for home automation
    "build": {
      "model": "ollama-local/qwen2.5-coder:7b",
      "prompt": "{file:~/.dotfiles/opencode/rules/coordinator.md} {file:~/.dotfiles/opencode/agents/build.md}",
      "permission": {
        "homeassistant_*": "allow"
      }
    },
    "plan": {
      "model": "ollama-local/qwen2.5-coder:7b",
      "prompt": "{file:~/.dotfiles/opencode/rules/coordinator.md} {file:~/.dotfiles/opencode/agents/plan.md}",
      "permission": {
        "homeassistant_Get*": "allow",
        "homeassistant_todo_get_items": "allow"
      }
    },

    // Built-in subagents
    "explore": {
      "model": "ollama-local/qwen2.5-coder:7b"
    },
    "compact": {
      "model": "ollama-local/llama3.2:3b"
    },

    // Custom subagents - model and personal-specific MCP permissions
    "coder": {
      "model": "ollama-local/deepseek-coder-v2:16b"
    },
    "reviewer": {
      "model": "ollama-local/deepseek-coder-v2:16b",
      "permission": {
        "grafana_get_*": "allow",
        "grafana_list_*": "allow",
        "grafana_query_*": "allow",
        "grafana_search_*": "allow"
      }
    },
    "architect": {
      "model": "ollama-local/deepseek-coder-v2:16b",
      "permission": {
        "grafana_get_*": "allow",
        "grafana_list_*": "allow",
        "grafana_search_*": "allow"
      }
    },
    "devops": {
      "model": "ollama-local/qwen2.5-coder:7b",
      "permission": {
        "grafana_*": "allow"
      }
    },
    "writer": {
      "model": "ollama-local/qwen2.5-coder:7b"
    },
    "researcher": {
      "model": "ollama-local/qwen2.5-coder:7b",
      "permission": {
        "grafana_get_*": "allow",
        "grafana_list_*": "allow",
        "grafana_query_*": "allow",
        "grafana_fetch_*": "allow",
        "grafana_search_*": "allow",
        "grafana_find_*": "allow"
      }
    },
    "git": {
      "model": "ollama-local/deepseek-coder-v2:16b"
    },
    "creative": {
      "model": "ollama-local/qwen2.5-coder:7b"
    }
  },

  "mcp": {
    "memory": {
      "type": "local",
      "command": [
        "docker",
        "run",
        "--rm",
        "-i",
        "--network=none",
        "--memory=512m",
        "--cpus=1",
        "-v",
        "mcp-memory:/app/dist",
        "mcp/memory"
      ],
      "enabled": true
    },

    "homeassistant": {
      "type": "remote",
      "url": "https://hass.cluster.arpa/api/mcp",
      "enabled": true,
      "headers": {
        "Authorization": "Bearer {env:HOMEASSISTANT_TOKEN}"
      }
    },

    "grafana": {
      "type": "remote",
      "url": "https://mcp-grafana.cluster.arpa/sse",
      "enabled": true
    }
  }
}
