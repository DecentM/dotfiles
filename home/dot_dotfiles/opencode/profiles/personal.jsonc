{
  "$schema": "https://opencode.ai/config.json",
  "theme": "ariake-dark",
  "share": "manual",
  "instructions": ["~/.dotfiles/opencode/rules/personal.md"],

  "small_model": "openrouter/minimax/minimax-m1",

  // Model selection and profile-specific permission overrides
  // Agent behavior is defined in agents/*.md files
  "agent": {
    // Primary agents - homeassistant access for home automation
    "build": {
      "model": "openrouter/qwen/qwen3-coder:free",
      "prompt": "{file:~/.dotfiles/opencode/rules/coordinator.md} {file:~/.dotfiles/opencode/agents/build.md}",
      "permission": {
        "homeassistant_*": "allow"
      }
    },
    "plan": {
      "model": "openrouter/meta-llama/llama-3.3-70b-instruct:free",
      "prompt": "{file:~/.dotfiles/opencode/rules/coordinator.md} {file:~/.dotfiles/opencode/agents/plan.md}",
      "permission": {
        "homeassistant_Get*": "allow",
        "homeassistant_todo_get_items": "allow"
      }
    },

    // Built-in subagents
    "explore": {
      "model": "openrouter/meta-llama/llama-3.3-70b-instruct:free"
    },
    "compact": {
      "model": "openrouter/minimax/minimax-m2.1"
    },

    // Custom subagents - model and personal-specific MCP permissions
    "coder": {
      "model": "openrouter/qwen/qwen3-coder:free"
    },
    "reviewer": {
      "model": "openrouter/qwen/qwen3-coder:free",
      "permission": {
        "grafana_get_*": "allow",
        "grafana_list_*": "allow",
        "grafana_query_*": "allow",
        "grafana_search_*": "allow"
      }
    },
    "architect": {
      "model": "openrouter/qwen/qwen3-coder:free",
      "permission": {
        "grafana_get_*": "allow",
        "grafana_list_*": "allow",
        "grafana_search_*": "allow"
      }
    },
    "devops": {
      "model": "openrouter/qwen/qwen3-coder:free",
      "permission": {
        "grafana_*": "allow"
      }
    },
    "writer": {
      "model": "openrouter/meta-llama/llama-3.3-70b-instruct:free"
    },
    "researcher": {
      "model": "openrouter/meta-llama/llama-3.3-70b-instruct:free",
      "permission": {
        "grafana_get_*": "allow",
        "grafana_list_*": "allow",
        "grafana_query_*": "allow",
        "grafana_fetch_*": "allow",
        "grafana_search_*": "allow",
        "grafana_find_*": "allow"
      }
    },
    "git": {
      "model": "openrouter/qwen/qwen3-coder:free"
    },
    "creative": {
      "model": "openrouter/meta-llama/llama-3.3-70b-instruct:free"
    }
  },

  "mcp": {
    "memory": {
      "type": "local",
      "command": [
        "docker",
        "run",
        "--rm",
        "-i",
        "--network=none",
        "--memory=512m",
        "--cpus=1",
        "-v",
        "mcp-memory:/app/dist",
        "mcp/memory"
      ],
      "enabled": true
    },

    "homeassistant": {
      "type": "remote",
      "url": "https://hass.cluster.arpa/api/mcp",
      "enabled": true,
      "headers": {
        "Authorization": "Bearer {env:HOMEASSISTANT_TOKEN}"
      }
    },

    "grafana": {
      "type": "remote",
      "url": "https://mcp-grafana.cluster.arpa/sse",
      "enabled": true
    }
  }
}
